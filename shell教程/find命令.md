# Linux find 命令

Linux find 命令用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则 find 命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。

### 语法

```bash
find   path   -option   [   -print ]   [ -exec   -ok   command ]   {} \;
```

**参数说明** :

find 根据下列规则判断 path 和 expression，在命令列上第一个 - ( ) , ! 之前的部份为 path，之后的是 expression。如果 path 是空字串则使用目前路径，如果 expression 是空字串则使用 -print 为预设 expression。

expression 中可使用的选项有二三十个之多，在此只介绍最常用的部份。

-mount, -xdev : 只检查和指定目录在同一个文件系统下的文件，避免列出其它文件系统中的文件

-amin n : 在过去 n 分钟内被读取过

-anewer file : 比文件 file 更晚被读取过的文件

-atime n : 在过去 n 天内被读取过的文件

-cmin n : 在过去 n 分钟内被修改过

-cnewer file :比文件 file 更新的文件

-ctime n : 在过去 n 天内创建的文件

-mtime n : 在过去 n 天内修改过的文件

-empty : 空的文件-gid n or -group name : gid 是 n 或是 group 名称是 name

-ipath p, -path p : 路径名称符合 p 的文件，ipath 会忽略大小写

-name name, -iname name : 文件名称符合 name 的文件。iname 会忽略大小写

-size n : 文件大小 是 n 单位，b 代表 512 位元组的区块，c 表示字元数，k 表示 kilo bytes，w 是二个位元组。

-type c : 文件类型是 c 的文件。

d: 目录

c: 字型装置文件

b: 区块装置文件

p: 具名贮列

f: 一般文件

l: 符号连结

s: socket

-pid n : process id 是 n 的文件

你可以使用 ( ) 将运算式分隔，并使用下列运算。

exp1 -and exp2

! expr

-not expr

exp1 -or exp2

exp1, exp2

### 实例

将当前目录及其子目录下所有文件后缀为 **.c** 的文件列出来:

```bash
# find . -name "*.c"
```

将当前目录及其子目录中的所有文件列出：

```bash
# find . -type f
```

将当前目录及其子目录下所有最近 20 天内更新过的文件列出:

```bash
# find . -ctime  20
```

查找 /var/log 目录中更改时间在 7 日以前的普通文件，并在删除之前询问它们：

```bash
# find /var/log -type f -mtime +7 -ok rm {} \;
```

查找当前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件：

```bash
# find . -type f -perm 644 -exec ls -l {} \;
```

查找系统中所有文件长度为 0 的普通文件，并列出它们的完整路径：

```bash
# find / -type f -size 0 -exec ls -l {} \;
```



### 笔记1

**场景1**：服务器磁盘满，一般由大的日志文件导致，需找到大文件并删除。

**解决1**: `find / -size +500M -print0|xargs -0 du -m|sort -nr`

find指令为找出500M以上的文件，print0和xargs -0配合使用，用来解决文件名中有空格或特殊字符问题。du -m是查看这些文件的大小，并以m为单位显示。最后sort -nr是按照数字反向排序（大的文件在前）

**解决2**：上述方法从根路径查找，可能列出一些系统文件。可以在这个查找之前先进行一下过滤。

使用`du -m -d 1 /|sort -nr ` 先看看根路径下，哪个文件夹比较大，并且有嫌疑是导致磁盘满的罪魁祸首。然后再基于那个目录进行find。

\----------------------------------------

**场景2:** 记得写过一个xxx.c的文件，但是忘了放哪里了

**解决：**` find / -name *xxx*.c` 模糊查找下这个文件



### 笔记2

find 按文件修改时间查找文件：

```
---(+n)----------|----------(n)----------|----------(-n)---
      (n+1)*24H前|   (n+1)*24H~n*24H间   |n*24H内
```

-  **-ctime -n** -- 查找距现在 n*24H 内修改过的文件
-  **-ctime n** -- 查找距现在 n*24H 前, (n+1)*24H 内修改过的文件
-  **-ctime +n** -- 查找距现在 (n+1)*24H 前修改过的文件
-  **[a|c|m]min** -- [最后访问|最后状态修改|最后内容修改]min
-  **[a|c|m]time** -- [最后访问|最后状态修改|最后内容修改]time

linux 文件的几种时间 (以 find 为例):

-  atime 最后一次访问时间, 如 ls, more 等, 但 chmod, chown, ls, stat 等不会修改些时间, 使用 ls -utl 可以按此时间顺序查看;
-  ctime 最后一次状态修改时间, 如 chmod, chown 等状态时间改变但修改时间不会改变, 使用 stat file 可以查看;
-  mtime 最后一次内容修改时间, 如 vi 保存后等, 修改时间发生改变的话, atime 和 ctime 也相应跟着发生改变。

注意: linux 里是不会记录文件的创建时间的, 除非这个文件自创建以来没有发生改变, 那么它的创建时间就是它的最后一次修改时间。

按修改时间顺序查看：

```
ls -lt  ./ 
```

按访问时间顺序查看：

```
ls -lut ./ 
```

如果想反序查看的话需要加一个选项 **-r**。



### 笔记3

例如查找 **2013-08-08** 到 **2013-09-01** 号之间的文件，使用如下命令即可：

```
find /log/ -name 'production.log-2013*' -newermt '2013-08-08' ! -newermt '2013-09-01
```

2011/09/08 12:00 时间开始找一天內的，会列出 2011/09/07 12:00 ~ 2011/09/08 12:00 时间內的文件。

找出 3 天”以前”被改动过的文件 (前第三天以前 → 2011/09/05 12:00 以前的文件) (> 72 小时)

```
find /var/log/ -mtime +3 -type f -print
```

找出 3 天內被改动过的文件 (2011/09/05 12:00 ~ 2011/09/08 12:00 內的文件) (0 ~ 72 小时內)

```
find /var/log/ -mtime -3 -type f -print
```

找出前第 3 天被改动过的文件 (2011/09/04 12:00 ~ 2011/09/05 12:00 內的文件) (72 ~ 96 小时)

```
find /var/log/ -mtime 3 -type f -print
```

找出第 3 天被改动过的文件 (也可以这样写)

```
find /var/log/ -mtime +2 -mtime -4 -type f -print
```