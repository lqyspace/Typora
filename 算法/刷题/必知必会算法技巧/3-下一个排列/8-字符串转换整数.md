# 8-字符串转换整数(atoi)

[力扣8-字符串转换整数](https://leetcode.cn/problems/string-to-integer-atoi/description/)，难度中等

![image-20230825222334354](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202308252223486.png)

```java
class Solution {
    public int myAtoi(String s) {
        // 去除字符串的签到和尾部的空格
        s = s.trim();
        // 判断是否有符号字符
        int left = 0;
        if(left == s.length()) return 0;
        char f = '+';
        // 好好体会第3个条件所说的话
        if(s.charAt(left)=='+' || s.charAt(left)=='-')
            f = s.charAt(left++);
        
        // 开始计算数字
        int res = 0;
        while(left< s.length() && '0'<=s.charAt(left) && s.charAt(left)<='9'){
            res = res * 10 + s.charAt(left++)-'0';
            if(left>=s.length()) return f=='+'? res: 0-res;

            char num = s.charAt(left);
            // 先判断num是否是数字
            if(num<'0' || num > '9') break;
            
            if(res > Integer.MAX_VALUE/10)
                return f=='+'? Integer.MAX_VALUE: Integer.MIN_VALUE;
            
            if(res == Integer.MAX_VALUE/10 && (f=='+' && num >= '8' || f=='-' && num>='9'))
                return f=='+'? Integer.MAX_VALUE: Integer.MIN_VALUE;
        }
        return f=='+'? res: 0-res;        
    }
}
```

这个代码的逻辑会有一点问题：通不过实例 `-21474836482`

改进：

```java
class Solution {
    public int myAtoi(String s) {
        // 去除字符串的签到和尾部的空格
        s = s.trim();
        int left = 0;
        if(left == s.length()) return 0;
        char f = '+';
        // 好好体会第3个条件所说的话
        if(s.charAt(left)=='+' || s.charAt(left)=='-')
            f = s.charAt(left++);
        
        // 开始计算数字
        long res = 0;
        while(left< s.length() && '0'<=s.charAt(left) && s.charAt(left)<='9'){
            res = res * 10 + s.charAt(left++)-'0';
            if(res > Integer.MAX_VALUE)
                break;
        }
        if((int)res != res)
            return f=='+'? Integer.MAX_VALUE: Integer.MIN_VALUE;
        return f=='+'? (int)res: (int)-res;        
    }
}
```

官解：

```java
class Solution {
    public int myAtoi(String str) {
        int n = str.length();
        int i = 0;
        // 记录正负号
        int sign = 1;
        // 用 long 避免 int 溢出
        long res = 0;
        // 跳过前导空格
        while (i < n && str.charAt(i) == ' ') {
            i++;
        }
        if (i == n) {
            return 0;
        }

        // 记录符号位
        if (str.charAt(i) == '-') {
            sign = -1;
            i++;
        } else if (str.charAt(i) == '+') {
            i++;
        }
        if (i == n) {
            return 0;
        }

        // 统计数字位
        while (i < n && '0' <= str.charAt(i) && str.charAt(i) <= '9') {
            res = res * 10 + str.charAt(i) - '0';
            if (res > Integer.MAX_VALUE) {
                break;
            }
            i++;
        }
        // 如果溢出，强转成 int 就会和真实值不同
        if ((int) res != res) {
            return sign == 1 ? Integer.MAX_VALUE : Integer.MIN_VALUE;
        }
        return (int) res * sign;
    }
}
```

