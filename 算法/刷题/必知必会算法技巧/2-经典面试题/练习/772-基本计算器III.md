# 772-基本计算器III

[772-基本计算器](https://leetcode.cn/problems/basic-calculator-iii/)，难度困难

![image-20230923135116967](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202309231351026.png)

```java
class Solution {
    public int calculate(String s) {
		Deque<Character> dq = new ArrayDeque();
        for(char c: s.toCharArray()){
            dq.offer(c);
        }
        return helper(dq);
    }
    
    public int helper(Deque<Character> dq){
        Stack<Integer> stk = new Stack();
        int num = 0;
        char sign = '+';
        
        while(!dq.isEmpty()){
            char c = dq.poll();
            if(Character.isDigit(c)){
                num = num*10 + (c - '0');
            }
            if(c == '('){
                num = helper(dq);
            }
            if(!Character.isDigit(c) && c!=' ' || dq.isEmpty()){
                if(sign == '+'){
                    stk.push(num);
                }else if(sign=='-'){
                    stk.push(-num);
                }else if(sign=='*'){
                    stk.push(stk.pop() * num);
                }else if(sign=='/'){
                    stk.push(stk.pop() / num);
                }
                
                num = 0;
                sign = c;
            }
            if(c==')') break;
        }
        
        int ans = 0;
        while(!stk.isEmpty()){
            ans += stk.pop();
        }
        return ans;
    }
}
```