# å›æº¯ç®—æ³•æœ€ä½³å®è·µï¼šæ‹¬å·ç”Ÿæˆ

è¯»å®Œæœ¬æ–‡ï¼Œä½ ä¸ä»…å­¦ä¼šäº†ç®—æ³•å¥—è·¯ï¼Œè¿˜å¯ä»¥é¡ºä¾¿è§£å†³å¦‚ä¸‹é¢˜ç›®ï¼š

|                           LeetCode                           |                             åŠ›æ‰£                             | éš¾åº¦ |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :--: |
| [22. Generate Parentheses](https://leetcode.com/problems/generate-parentheses/) | [22. æ‹¬å·ç”Ÿæˆ](https://leetcode.cn/problems/generate-parentheses/) |  ğŸŸ    |
|                              -                               | [å‰‘æŒ‡ Offer II 085. ç”ŸæˆåŒ¹é…çš„æ‹¬å·](https://leetcode.cn/problems/IDBivT/) |  ğŸŸ    |

æ‹¬å·é—®é¢˜å¯ä»¥ç®€å•åˆ†æˆä¸¤ç±»ï¼Œä¸€ç±»æ˜¯å‰æ–‡å†™è¿‡çš„ [æ‹¬å·çš„åˆæ³•æ€§åˆ¤æ–­](https://labuladong.github.io/algo/di-san-zha-24031/jing-dian--a94a0/ru-he-jie--306f6/) ï¼Œä¸€ç±»æ˜¯åˆæ³•æ‹¬å·çš„ç”Ÿæˆã€‚å¯¹äºæ‹¬å·åˆæ³•æ€§çš„åˆ¤æ–­ï¼Œä¸»è¦æ˜¯å€ŸåŠ©ã€Œæ ˆã€è¿™ç§æ•°æ®ç»“æ„ï¼Œè€Œå¯¹äºæ‹¬å·çš„ç”Ÿæˆï¼Œä¸€èˆ¬éƒ½è¦åˆ©ç”¨å›æº¯é€’å½’çš„æ€æƒ³ã€‚

å…³äºå›æº¯ç®—æ³•ï¼Œæˆ‘ä»¬å‰æ–‡å†™è¿‡ä¸€ç¯‡ [å›æº¯ç®—æ³•å¥—è·¯æ¡†æ¶è¯¦è§£](https://labuladong.github.io/algo/di-ling-zh-bfe1b/hui-su-sua-c26da/) åå“éå¸¸å¥½ï¼Œè¯»æœ¬æ–‡å‰åº”è¯¥è¯»è¿‡é‚£ç¯‡æ–‡ç« ï¼Œè¿™æ ·ä½ å°±èƒ½å¤Ÿè¿›ä¸€æ­¥äº†è§£å›æº¯ç®—æ³•çš„æ¡†æ¶ä½¿ç”¨æ–¹æ³•äº†ã€‚

å›åˆ°æ­£é¢˜ï¼Œçœ‹ä¸‹åŠ›æ‰£ç¬¬ 22 é¢˜ã€Œ[æ‹¬å·ç”Ÿæˆ](https://leetcode.cn/problems/generate-parentheses/)ã€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

è¯·ä½ å†™ä¸€ä¸ªç®—æ³•ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªæ­£æ•´æ•° `n`ï¼Œè¾“å‡ºæ˜¯ `n` å¯¹å„¿æ‹¬å·çš„æ‰€æœ‰åˆæ³•ç»„åˆï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```java
List<String> generateParenthesis(int n);
```

æ¯”å¦‚è¯´ï¼Œè¾“å…¥ `n=3`ï¼Œè¾“å‡ºä¸ºå¦‚ä¸‹ 5 ä¸ªå­—ç¬¦ä¸²ï¼š

```bash
"((()))",
"(()())",
"(())()",
"()(())",
"()()()"
```

æœ‰å…³æ‹¬å·é—®é¢˜ï¼Œä½ åªè¦è®°ä½ä»¥ä¸‹æ€§è´¨ï¼Œæ€è·¯å°±å¾ˆå®¹æ˜“æƒ³å‡ºæ¥ï¼š

**1ã€ä¸€ä¸ªã€Œåˆæ³•ã€æ‹¬å·ç»„åˆçš„å·¦æ‹¬å·æ•°é‡ä¸€å®šç­‰äºå³æ‹¬å·æ•°é‡ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£**ã€‚

**2ã€å¯¹äºä¸€ä¸ªã€Œåˆæ³•ã€çš„æ‹¬å·å­—ç¬¦ä¸²ç»„åˆ `p`ï¼Œå¿…ç„¶å¯¹äºä»»ä½• `0 <= i < len(p)` éƒ½æœ‰ï¼šå­ä¸² `p[0..i]` ä¸­å·¦æ‹¬å·çš„æ•°é‡éƒ½å¤§äºæˆ–ç­‰äºå³æ‹¬å·çš„æ•°é‡**ã€‚

å¦‚æœä¸è·Ÿä½ è¯´è¿™ä¸ªæ€§è´¨ï¼Œå¯èƒ½ä¸å¤ªå®¹æ˜“å‘ç°ï¼Œä½†æ˜¯ç¨å¾®æƒ³ä¸€ä¸‹ï¼Œå…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºä»å·¦å¾€å³ç®—çš„è¯ï¼Œè‚¯å®šæ˜¯å·¦æ‹¬å·å¤šå˜›ï¼Œåˆ°æœ€åå·¦å³æ‹¬å·æ•°é‡ç›¸ç­‰ï¼Œè¯´æ˜è¿™ä¸ªæ‹¬å·ç»„åˆæ˜¯åˆæ³•çš„ã€‚

åä¹‹ï¼Œæ¯”å¦‚è¿™ä¸ªæ‹¬å·ç»„åˆ `))((`ï¼Œå‰å‡ ä¸ªå­ä¸²éƒ½æ˜¯å³æ‹¬å·å¤šäºå·¦æ‹¬å·ï¼Œæ˜¾ç„¶ä¸æ˜¯åˆæ³•çš„æ‹¬å·ç»„åˆã€‚

ä¸‹é¢å°±æ¥æ‰‹æŠŠæ‰‹å®è·µä¸€ä¸‹å›æº¯ç®—æ³•æ¡†æ¶ã€‚



## å›æº¯æ€è·¯

æ˜ç™½äº†åˆæ³•æ‹¬å·çš„æ€§è´¨ï¼Œå¦‚ä½•æŠŠè¿™é“é¢˜å’Œå›æº¯ç®—æ³•æ‰¯ä¸Šå…³ç³»å‘¢ï¼Ÿ

ç®—æ³•è¾“å…¥ä¸€ä¸ªæ•´æ•° `n`ï¼Œè®©ä½ è®¡ç®— **`n` å¯¹å„¿æ‹¬å·**èƒ½ç»„æˆå‡ ç§åˆæ³•çš„æ‹¬å·ç»„åˆï¼Œå¯ä»¥æ”¹å†™æˆå¦‚ä¸‹é—®é¢˜ï¼š

**ç°åœ¨æœ‰ `2n` ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®å¯ä»¥æ”¾ç½®å­—ç¬¦ `(` æˆ–è€… `)`ï¼Œç»„æˆçš„æ‰€æœ‰æ‹¬å·ç»„åˆä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæ˜¯åˆæ³•çš„**ï¼Ÿ

è¿™ä¸ªå‘½é¢˜å’Œé¢˜ç›®çš„æ„æ€å®Œå…¨æ˜¯ä¸€æ ·çš„å¯¹å§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæƒ³æƒ³å¦‚ä½•å¾—åˆ°å…¨éƒ¨ `2^(2n)` ç§ç»„åˆï¼Œç„¶åå†æ ¹æ®æˆ‘ä»¬åˆšæ‰æ€»ç»“å‡ºçš„åˆæ³•æ‹¬å·ç»„åˆçš„æ€§è´¨ç­›é€‰å‡ºåˆæ³•çš„ç»„åˆï¼Œä¸å°±å®Œäº‹å„¿äº†ï¼Ÿ

å¦‚ä½•å¾—åˆ°æ‰€æœ‰çš„ç»„åˆå‘¢ï¼Ÿè¿™å°±æ˜¯æ ‡å‡†çš„æš´åŠ›ç©·ä¸¾å›æº¯æ¡†æ¶å•Šï¼Œæˆ‘ä»¬å‰æ–‡ [å›æº¯ç®—æ³•å¥—è·¯æ¡†æ¶è¯¦è§£](https://labuladong.github.io/algo/di-ling-zh-bfe1b/hui-su-sua-c26da/) éƒ½æ€»ç»“è¿‡äº†ï¼š

```python
result = []
def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨):
    if æ»¡è¶³ç»“æŸæ¡ä»¶:
        result.add(è·¯å¾„)
        return
    
    for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨:
        åšé€‰æ‹©
        backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)
        æ’¤é”€é€‰æ‹©
```

é‚£ä¹ˆå¯¹äºæˆ‘ä»¬çš„éœ€æ±‚ï¼Œå¦‚ä½•æ‰“å°æ‰€æœ‰æ‹¬å·ç»„åˆå‘¢ï¼Ÿå¥—ä¸€ä¸‹æ¡†æ¶å°±å‡ºæ¥äº†ï¼Œä¼ªç å¦‚ä¸‹ï¼š

```cpp
void backtrack(int n, int i, string& track) {
    // i ä»£è¡¨å½“å‰çš„ä½ç½®ï¼Œå…± 2n ä¸ªä½ç½®
    // ç©·ä¸¾åˆ°æœ€åä¸€ä¸ªä½ç½®äº†ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º 2n ç»„åˆ
    if (i == 2 * n) {
        print(track);
        return;
    }

    // å¯¹äºæ¯ä¸ªä½ç½®å¯ä»¥æ˜¯å·¦æ‹¬å·æˆ–è€…å³æ‹¬å·ä¸¤ç§é€‰æ‹©
    for choice in ['(', ')'] {
        track.push(choice); // åšé€‰æ‹©
        // ç©·ä¸¾ä¸‹ä¸€ä¸ªä½ç½®
        backtrack(n, i + 1, track);
        track.pop(choice); // æ’¤é”€é€‰æ‹©
    }
}
```

é‚£ä¹ˆï¼Œç°åœ¨èƒ½å¤Ÿæ‰“å°æ‰€æœ‰æ‹¬å·ç»„åˆäº†ï¼Œå¦‚ä½•ä»å®ƒä»¬ä¸­ç­›é€‰å‡ºåˆæ³•çš„æ‹¬å·ç»„åˆå‘¢ï¼Ÿå¾ˆç®€å•ï¼ŒåŠ å‡ ä¸ªæ¡ä»¶è¿›è¡Œã€Œå‰ªæã€å°±è¡Œäº†ã€‚

å¯¹äº `2n` ä¸ªä½ç½®ï¼Œå¿…ç„¶æœ‰ `n` ä¸ªå·¦æ‹¬å·ï¼Œ`n` ä¸ªå³æ‹¬å·ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ˜¯ç®€å•çš„è®°å½•ç©·ä¸¾ä½ç½® `i`ï¼Œè€Œæ˜¯**ç”¨ `left` è®°å½•è¿˜å¯ä»¥ä½¿ç”¨å¤šå°‘ä¸ªå·¦æ‹¬å·ï¼Œç”¨ `right` è®°å½•è¿˜å¯ä»¥ä½¿ç”¨å¤šå°‘ä¸ªå³æ‹¬å·**ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡åˆšæ‰æ€»ç»“çš„åˆæ³•æ‹¬å·è§„å¾‹è¿›è¡Œç­›é€‰äº†ï¼š

```java
public List<String> generateParenthesis(int n) {
    if (n == 0) return new ArrayList<>();
    // è®°å½•æ‰€æœ‰åˆæ³•çš„æ‹¬å·ç»„åˆ
    List<String> res = new ArrayList<>();
    // å›æº¯è¿‡ç¨‹ä¸­çš„è·¯å¾„
    StringBuilder track = new StringBuilder();
    // å¯ç”¨çš„å·¦æ‹¬å·å’Œå³æ‹¬å·æ•°é‡åˆå§‹åŒ–ä¸º n
    backtrack(n, n, track, res);
    return res;
}


// å¯ç”¨çš„å·¦æ‹¬å·æ•°é‡ä¸º left ä¸ªï¼Œå¯ç”¨çš„å³æ‹¬å·æ•°é‡ä¸º rgiht ä¸ª
void backtrack(int left, int right, 
            StringBuilder track, List<String> res) {
    // è‹¥å·¦æ‹¬å·å‰©ä¸‹çš„å¤šï¼Œè¯´æ˜ä¸åˆæ³•
    if (right < left) return;
    // æ•°é‡å°äº 0 è‚¯å®šæ˜¯ä¸åˆæ³•çš„
    if (left < 0 || right < 0) return;
    // å½“æ‰€æœ‰æ‹¬å·éƒ½æ°å¥½ç”¨å®Œæ—¶ï¼Œå¾—åˆ°ä¸€ä¸ªåˆæ³•çš„æ‹¬å·ç»„åˆ
    if (left == 0 && right == 0) {
        res.add(track.toString());
        return;
    }
    
    // å°è¯•æ”¾ä¸€ä¸ªå·¦æ‹¬å·
    track.append('('); // é€‰æ‹©
    backtrack(left - 1, right, track, res);
    track.deleteCharAt(track.length() - 1); // æ’¤æ¶ˆé€‰æ‹©

    // å°è¯•æ”¾ä¸€ä¸ªå³æ‹¬å·
    track.append(')'); // é€‰æ‹©
    backtrack(left, right - 1, track, res);
    track.deleteCharAt(track.length() - 1); // æ’¤æ¶ˆé€‰æ‹©
}
```



è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç®—æ³•å°±å®Œæˆäº†ï¼Œç®—æ³•çš„å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿè¿™ä¸ªæ¯”è¾ƒéš¾åˆ†æï¼Œ**å¯¹äºé€’å½’ç›¸å…³çš„ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦è¿™æ ·è®¡ç®—ï¼ˆé€’å½’æ¬¡æ•°ï¼‰\*ï¼ˆé€’å½’å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦ï¼‰**ã€‚

`backtrack` å°±æ˜¯æˆ‘ä»¬çš„é€’å½’å‡½æ•°ï¼Œå…¶ä¸­æ²¡æœ‰ä»»ä½• for å¾ªç¯ä»£ç ï¼Œæ‰€ä»¥é€’å½’å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼Œä½†å…³é”®æ˜¯è¿™ä¸ªå‡½æ•°çš„é€’å½’æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿæ¢å¥è¯è¯´ï¼Œç»™å®šä¸€ä¸ª `n`ï¼Œ`backtrack` å‡½æ•°é€’å½’è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ï¼Ÿ

æˆ‘ä»¬å‰é¢æ€ä¹ˆåˆ†æåŠ¨æ€è§„åˆ’ç®—æ³•çš„é€’å½’æ¬¡æ•°çš„ï¼Ÿä¸»è¦æ˜¯çœ‹ã€ŒçŠ¶æ€ã€çš„ä¸ªæ•°å¯¹å§ã€‚å…¶å®å›æº¯ç®—æ³•å’ŒåŠ¨æ€è§„åˆ’çš„æœ¬è´¨éƒ½æ˜¯ç©·ä¸¾ï¼Œåªä¸è¿‡åŠ¨æ€è§„åˆ’å­˜åœ¨ã€Œé‡å å­é—®é¢˜ã€å¯ä»¥ä¼˜åŒ–ï¼Œè€Œå›æº¯ç®—æ³•ä¸å­˜åœ¨è€Œå·²ã€‚

æ‰€ä»¥è¯´è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ã€ŒçŠ¶æ€ã€è¿™ä¸ªæ¦‚å¿µï¼Œ**å¯¹äº `backtrack` å‡½æ•°ï¼ŒçŠ¶æ€æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ `left, right, track`**ï¼Œè¿™ä¸‰ä¸ªå˜é‡çš„æ‰€æœ‰ç»„åˆä¸ªæ•°å°±æ˜¯ `backtrack` å‡½æ•°çš„çŠ¶æ€ä¸ªæ•°ï¼ˆè°ƒç”¨æ¬¡æ•°ï¼‰ã€‚

`left` å’Œ `right` çš„ç»„åˆå¥½åŠï¼Œä»–ä¿©å–å€¼å°±æ˜¯ 0~n å˜›ï¼Œç»„åˆèµ·æ¥ä¹Ÿå°± `n^2` ç§è€Œå·²ï¼›è¿™ä¸ª `track` çš„é•¿åº¦è™½ç„¶å–åœ¨ `0~2n`ï¼Œä½†å¯¹äºæ¯ä¸€ä¸ªé•¿åº¦ï¼Œå®ƒè¿˜æœ‰æŒ‡æ•°çº§çš„æ‹¬å·ç»„åˆï¼Œè¿™ä¸ªæ˜¯ä¸å¥½ç®—çš„ã€‚

è¯´äº†è¿™ä¹ˆå¤šï¼Œå°±æ˜¯æƒ³è®©å¤§å®¶çŸ¥é“è¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦æ˜¯æŒ‡æ•°çº§ï¼Œè€Œä¸”ä¸å¥½ç®—ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å±•å¼€äº†ï¼Œæ˜¯ `4^n / sqrt(n)`ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥æœç´¢ä¸€ä¸‹ã€Œå¡ç‰¹å…°æ•°ã€ç›¸å…³çš„çŸ¥è¯†äº†è§£ä¸€ä¸‹è¿™ä¸ªå¤æ‚åº¦æ˜¯æ€ä¹ˆç®—çš„ã€‚