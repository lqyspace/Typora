# 2034-股票价格波动

[2034-股票价格波动](https://leetcode.cn/problems/stock-price-fluctuation/description/?envType=daily-question&envId=2023-10-08)，难度中等

![image-20231009104739260](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202310091047376.png)

题解：**哈希表+有序集合**

![image-20231009112047335](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202310091120804.png)

```java
class StockPrice{
    int maxTimestamp; // 记录最新的时间
    HashMap<Integer, Integer> timePriceMap;
    TreeMap<Integer, Integer> priceCounts;
    public StockPrice(){
        maxTimestamp = 0;
        timePriceMap = new HashMap<>();
        priceCounts = new TreeMap<>();
    }
    public void update(int timestamp, int price){
        maxTimestamp = Math.max(maxTimestamp, timestamp);
        int prevPrice = timePriceMap.getOrDefault(timestamp, 0);
        timePriceMap.put(timestamp, price);
        if(prevPrice>0){// 更新
            priceCounts.put(prevPrice, priceCounts.get(prevPrice)-1);
            if(priceCounts.get(prevPrice)==0){
                priceCounts.remove(prevPrice);
            }
        }
        priceCounts.put(price, priceCounts.getOrDefault(price, 0)+1);
    }
    
    public int current(){
        return timePriceMap.get(maxTimestamp);
    }
    public int maximum(){
        return priceCounts.lastKey();
    }
    public int minimum(){
        return priceCounts.firstKey();
    }
}
```

![image-20231009112317984](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202310091123069.png)



题解：**哈希表+两个优先队列**

![image-20231009112028508](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202310091120609.png)

```java
class StockPrice{
    int maxTimestamp;
    HashMap<Integer, Integer> timePriceMap;
    PriorityQueue<int[]> pqMax;
    PriorityQueue<int[]> pqMin;
    
    public StockPrice(){
        maxTimestamp = 0;
        timePriceMap = new HashMap<>();
        pqMax = new PriorityQueue<int[]>((a, b)->b[0] - a[0]);
        pqMin = new PriorityQueue<int[]>((a, b)->a[0] - b[0]);
    }
    
    public void update(int timestamp, int price){
        maxTimestamp = Math.max(maxTimestamp, timestamp);
        timePriceMap.put(timestamp, price);
        pqMax.offer(new int[]{price, timestamp});
        pqMin.offer(new int[]{price, timestamp});
    }
    
    public int current(){
        return timePriceMap.get(maxTimestamp);
    }
    
    public int maximum(){
        while(true){
            int[] priceTime = pqMax.peek();
            int price = priceTime[0], timestamp = priceTime[1];
            if(timePriceMap.get(timestamp) == price){
                return price;
            }
            // 如果不相等，说明值过期了，则删除
            pqMax.poll();
        }
    }
    
    public int minimum(){
         while(true){
             int[] pt = pqMin.peek();
             int price = pt[0], timestamp = pt[1];
             if(timePriceMap.get(timestamp)==price){
                 return price;
             }
             // 如果不相等，说明值过期了，则删除
             pqMin.poll();
         }
    }
}
```

![image-20231009112258289](https://raw.githubusercontent.com/lqyspace/mypic/master/PicBed/202310091122389.png)